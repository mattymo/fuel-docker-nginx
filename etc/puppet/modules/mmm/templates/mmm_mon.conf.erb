###########################################################
# PUPPET MANAGED                                          #
# Do not edit this file on a server node unless you       #
# are willing to have your changes overwritten by         #
# Puppet.  If you really want to change the contents      #
# repository and check it out on the puppet server.       #
###########################################################

include mmm_common<% if scope.lookupvar('mmm::params::multi_cluster_monitor') == true %><% if cluster_name != '' %>_<%= cluster_name %><% end %><% end %>.conf

<monitor>
  ip              <%= scope.lookupvar("monitor_ip")%>
  pid_path        /var/run/mmm_mond<% if scope.lookupvar('mmm::params::multi_cluster_monitor') == true %><% if cluster_name != '' %>_<%= cluster_name %><% end %><% end %>.pid
  bin_path        /usr/lib/mysql-mmm/
  status_path     /var/lib/misc/mmm_mond<% if scope.lookupvar('mmm::params::multi_cluster_monitor') == true %><% if cluster_name != '' %>_<%= cluster_name %><% end %><% end %>.status
<% ips = []; mastersflat = masters.flatten; 
   mastersflat.each_index { |i| ips << mastersflat[i] if i % 3 == 1 }
  slaves.each_index{ |i| ips << slaves[i] if i % 2 == 1 } -%>
  ping_ips        <%= ips.join(', ') %>
  auto_set_online 60
  <% if cluster_name != '' %>port          <%= port %><% end %>
</monitor>

<host default>
  monitor_user        <%= scope.lookupvar("monitor_user")%>
  monitor_password    <%= scope.lookupvar("monitor_password")%>
</host>

debug 0
